CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
UNWIND [{_id:0, properties:{interval:["1580-Now"], title:"Name"}}, {_id:1, properties:{interval:["1902-Now"], title:"Name"}}, {_id:2, properties:{interval:["1535-Now"], title:"Name"}}, {_id:3, properties:{interval:["1554-Now"], title:"Name"}}, {_id:4, properties:{interval:["43-Now"], title:"Name"}}, {_id:5, properties:{interval:["1949-Now"], title:"Name"}}, {_id:6, properties:{interval:["1947-Now"], title:"Name"}}, {_id:7, properties:{interval:["1954-Now"], title:"Name"}}, {_id:8, properties:{interval:["1965-Now"], title:"Name"}}, {_id:9, properties:{interval:["1985-Now"], title:"Name"}}, {_id:10, properties:{interval:["1930-Now"], title:"Name"}}, {_id:11, properties:{interval:["1946-Now"], title:"Name"}}, {_id:12, properties:{interval:["1966-Now"], title:"Name"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Attribute;
UNWIND [{_id:13, properties:{interval:["1580-Now"], title:"City"}}, {_id:14, properties:{interval:["1902-Now"], title:"City"}}, {_id:15, properties:{interval:["1535-Now"], title:"City"}}, {_id:16, properties:{interval:["1554-Now"], title:"City"}}, {_id:17, properties:{interval:["43-Now"], title:"City"}}, {_id:18, properties:{interval:["1949-Now"], title:"Airport", id: 18}}, {_id:19, properties:{interval:["1947-Now"], title:"Airport", id: 19}}, {_id:20, properties:{interval:["1954-Now"], title:"Airport", id: 20}}, {_id:21, properties:{interval:["1965-Now"], title:"Airport", id: 21}}, {_id:22, properties:{interval:["1985-Now"], title:"Airport", id: 22}}, {_id:23, properties:{interval:["1930-Now"], title:"Airport", id: 23}}, {_id:24, properties:{interval:["1946-Now"], title:"Airport", id: 24}}, {_id:25, properties:{interval:["1966-Now"], title:"Airport", id: 25}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Object;
UNWIND [{_id:26, properties:{interval:["1580-Now"], value:"Buenos Aires"}}, {_id:27, properties:{interval:["1902-Now"], value:"Bariloche"}}, {_id:28, properties:{interval:["1535-Now"], value:"Lima"}}, {_id:29, properties:{interval:["1554-Now"], value:"Sao Paulo"}}, {_id:30, properties:{interval:["43-Now"], value:"London"}}, {_id:31, properties:{interval:["1949-Now"], value:"EZE"}}, {_id:32, properties:{interval:["1947-Now"], value:"AEP"}}, {_id:33, properties:{interval:["1954-Now"], value:"BRC"}}, {_id:34, properties:{interval:["1965-Now"], value:"LIM"}}, {_id:35, properties:{interval:["1985-Now"], value:"GRU"}}, {_id:36, properties:{interval:["1930-Now"], value:"LGW"}}, {_id:37, properties:{interval:["1946-Now"], value:"LHR"}}, {_id:38, properties:{interval:["1966-Now"], value:"STN"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Value;
UNWIND [{start: {_id:18}, end: {_id:13}, properties:{interval:["1949-Now"]}}, {start: {_id:19}, end: {_id:13}, properties:{interval:["1947-Now"]}}, {start: {_id:20}, end: {_id:14}, properties:{interval:["1954-Now"]}}, {start: {_id:21}, end: {_id:15}, properties:{interval:["1965-Now"]}}, {start: {_id:22}, end: {_id:16}, properties:{interval:["1985-Now"]}}, {start: {_id:23}, end: {_id:17}, properties:{interval:["1930-Now"]}}, {start: {_id:24}, end: {_id:17}, properties:{interval:["1946-Now"]}}, {start: {_id:25}, end: {_id:17}, properties:{interval:["1966-Now"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:LocatedAt]->(end) SET r += row.properties;
UNWIND [{start: {_id:0}, end: {_id:26}, properties:{}}, {start: {_id:1}, end: {_id:27}, properties:{}}, {start: {_id:2}, end: {_id:28}, properties:{}}, {start: {_id:3}, end: {_id:29}, properties:{}}, {start: {_id:4}, end: {_id:30}, properties:{}}, {start: {_id:5}, end: {_id:31}, properties:{}}, {start: {_id:6}, end: {_id:32}, properties:{}}, {start: {_id:7}, end: {_id:33}, properties:{}}, {start: {_id:8}, end: {_id:34}, properties:{}}, {start: {_id:9}, end: {_id:35}, properties:{}}, {start: {_id:10}, end: {_id:36}, properties:{}}, {start: {_id:11}, end: {_id:37}, properties:{}}, {start: {_id:12}, end: {_id:38}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:Edge]->(end) SET r += row.properties;
UNWIND [{start: {_id:18}, end: {_id:24}, properties:{interval:["2020-03-07 11:40—2020-03-07 21:40", "2020-03-08 11:40—2020-03-08 21:40"], flightNumber:["BA244", "BA244"]}}, {start: {_id:24}, end: {_id:18}, properties:{interval:["2020-03-07 22:30—2020-03-08 09:10"], flightNumber:["BA245"]}}, {start: {_id:18}, end: {_id:23}, properties:{interval:["2020-03-07 11:40—2020-03-07 21:30"], flightNumber:["DI7506"]}}, {start: {_id:23}, end: {_id:18}, properties:{interval:["2020-03-07 23:15—2020-03-08 08:05"], flightNumber:["DI7505"]}}, {start: {_id:18}, end: {_id:21}, properties:{interval:["2020-03-07 11:40—2020-03-07 13:40"], flightNumber:["LP2468"]}}, {start: {_id:21}, end: {_id:18}, properties:{interval:["2020-03-08 10:35—2020-03-08 12:55"], flightNumber:["LP2429"]}}, {start: {_id:18}, end: {_id:22}, properties:{interval:["2020-03-07 16:05—2020-03-07 18:25"], flightNumber:["AR1286"]}}, {start: {_id:22}, end: {_id:18}, properties:{interval:["2020-03-08 08:25—2020-03-08 11:30"], flightNumber:["JJ8003"]}}, {start: {_id:21}, end: {_id:23}, properties:{interval:["2020-03-07 15:00—2020-03-07 21:00"], flightNumber:["BA2238"]}}, {start: {_id:23}, end: {_id:21}, properties:{interval:["2020-03-07 23:35—2020-03-08 10:30"], flightNumber:["BA2239"]}}, {start: {_id:22}, end: {_id:24}, properties:{interval:["2020-03-07 22:30—2020-03-08 06:55"], flightNumber:["BA246"]}}, {start: {_id:24}, end: {_id:22}, properties:{interval:["2020-03-07 21:00—2020-03-08 05:00"], flightNumber:["BA247"]}}, {start: {_id:18}, end: {_id:20}, properties:{interval:["2020-03-07 13:00—2020-03-07 15:25", "2020-03-08 13:00—2020-03-08 15:25"], flightNumber:["AR1678", "AR1678"]}}, {start: {_id:20}, end: {_id:18}, properties:{interval:["2020-03-07 09:30—2020-03-07 11:35"], flightNumber:["AR1873"]}}, {start: {_id:20}, end: {_id:22}, properties:{interval:["2020-03-07 17:00—2020-03-07 21:35"], flightNumber:["AR2020"]}}, {start: {_id:20}, end: {_id:19}, properties:{interval:["2020-03-07 21:00—2020-03-07 23:00"], flightNumber:["AR123"]}}, {start: {_id:19}, end: {_id:25}, properties:{interval:["2020-03-08 05:00—2020-03-08 15:00"], flightNumber:["AR4321"]}}, {start: {_id:25}, end: {_id:22}, properties:{interval:["2020-03-07 22:40—2020-03-08 06:00"], flightNumber:["BA222"]}}, {start: {_id:22}, end: {_id:20}, properties:{interval:["2020-03-08 10:00—2020-03-08 14:35"], flightNumber:["AR2021"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:Flight]->(end) SET r += row.properties;
UNWIND [{start: {_id:13}, end: {_id:0}, properties:{}}, {start: {_id:14}, end: {_id:1}, properties:{}}, {start: {_id:15}, end: {_id:2}, properties:{}}, {start: {_id:16}, end: {_id:3}, properties:{}}, {start: {_id:17}, end: {_id:4}, properties:{}}, {start: {_id:18}, end: {_id:5}, properties:{}}, {start: {_id:19}, end: {_id:6}, properties:{}}, {start: {_id:20}, end: {_id:7}, properties:{}}, {start: {_id:21}, end: {_id:8}, properties:{}}, {start: {_id:22}, end: {_id:9}, properties:{}}, {start: {_id:23}, end: {_id:10}, properties:{}}, {start: {_id:24}, end: {_id:11}, properties:{}}, {start: {_id:25}, end: {_id:12}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:Edge]->(end) SET r += row.properties;
MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
